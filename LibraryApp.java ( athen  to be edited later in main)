package com.library.main;

import com.library.models.*;
import com.library.services.*;
import java.util.*;

public class LibraryApp {

    public static void main(String[] args) {

        // ---------- STEP 1: Load persisted data ----------
        List<Book> books = (List<Book>) FileManager.loadBooks();
        List<Member> members = (List<Member>) FileManager.loadMembers();
        List<Transaction> transactions = (List<Transaction>) FileManager.loadTransactions();

        System.out.println("Library data loaded successfully!");

        // ---------- STEP 2: Start AutoSave Thread ----------
        AutoSaveThread autoSave = new AutoSaveThread(books, members, transactions);
        autoSave.setDaemon(true);                 // run in background
        autoSave.start();
        System.out.println(" AutoSave thread started: " + autoSave.getName());

        // ---------- STEP 3: Simulate normal library operations ----------
        System.out.println(" Library System Running... (demo for 15 s)");
        try {
            Thread.sleep(15000);                  // pretend program is active
        } catch (InterruptedException e) {
            System.out.println("Main thread interrupted.");
        }

        // ---------- STEP 4: Demonstrate file operations ----------
        FileManager.writeUsingFileWriter("testFile.txt", "Hello from LibraryApp!");
        FileManager.readUsingFileReader("testFile.txt");
        FileManager.copyFile("testFile.txt", "copy_testFile.txt");
        FileManager.renameFile("copy_testFile.txt", "renamed_testFile.txt");
        FileManager.deleteFile("renamed_testFile.txt");

        // ---------- STEP 5: Stop AutoSave Thread ----------
        autoSave.stopSaving();
        System.out.println(" AutoSave thread stopped. Exiting LibraryApp...");
    }
}
